(function(){var a={};a.TYPE_STRING=0;a.TYPE_NUMBER=1;a.TYPE_BOOLEAN=2;a.TYPE_OBJECT=3;a.setItem=function(c,d,b){if(window.localStorage){b=b||{};try{localStorage.setItem(c,d);b.onSucceed&&b.onSucceed()}catch(f){b.onError&&b.onError()}}};a.getItem=function(b,c){if(window.localStorage){var d=localStorage.getItem(b);if(d===null||!d){return null}c=c||a.TYPE_STRING;switch(c){case a.TYPE_NUMBER:return d*1;case a.TYPE_BOOLEAN:if(d=="false"){return false}return !!d;case a.TYPE_OBJECT:return JSON.parse(d);default:return d}}return null};a.removeItem=function(b){if(window.localStorage){localStorage.removeItem(b)}};a.clear=function(){if(window.localStorage){localStorage.clear()}};a.each=function(d){if(window.localStorage){try{for(var b in localStorage){d(b,localStorage[b])}}catch(c){}}};window.Storage=a})();(function(){var d={};var f="gPlaceIndex";var g="gPlaceDataVersion";var e=Storage.getItem(f)||0;var a;var c=Storage.getItem(g);if(c==null){a="1.0";Storage.setItem(g,"1.0")}else{a=c}d.addPlaceData=function(h,i){i._index=e;Storage.setItem(h,JSON.stringify(i),{onSucceed:function(){e++;Storage.setItem(f,e)},onError:function(){b();d.addPlaceData(h,i)}})};d.getPlaceData=function(h){return Storage.getItem(h,Storage.TYPE_OBJECT)};d.checkVersion=function(h){if(h==a){return}a=h;Storage.setItem(g,h);Storage.each(function(i,j){if(i==f||i==g){return}Storage.removeItem(i)});e=0;Storage.setItem(f,0)};var b=function(j){j=j||5;var k=[];Storage.each(function(m,n){if(m==f){return}var l=JSON.parse(n);var i=parseInt(l._index);k.push({uid:m,index:i})});k.sort(function(l,i){return l.index-i.index});j=j>k.length?k.length:j;for(var h=0;h<j;h++){Storage.removeItem(k[h].uid)}};window.PlaceDataMgr=d})();